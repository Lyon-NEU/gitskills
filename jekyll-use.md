#Windows安装jekyll

##准备环境
1. 安装[ruby](http://rubyinstaller.org/downloads/)  
	我安装的是Ruby 2.0.0-p353
1. 安装[Ruby Development Kit](http://rubyinstaller.org/downloads/)  
	我安装的是DevKit-mingw64-32-4.7.2-20130224-1151-sfx.exe（For use with Ruby 2.0 (32bits version only)）  
	注意这里开发工具包要和ruby安装包版本匹配  
	解压DevKit-mingw64-32-4.7.2-20130224-1151-sfx.exe到c:\devkit
1. 安装[Python](http://www.python.org/getit/)或者[Portable Python](http://portablepython.com/wiki/PortablePython2.7.5.1/)
	这里极力推荐安装python2.7.x系列而不是3.x系列

ps.[ruby中文](https://www.ruby-lang.org/zh_cn/downloads/)
##执行配置
**1.运行命令**
<pre>
C:\devkit>ruby dk.rb init
[INFO] found RubyInstaller v2.0.0 at C:/ruby

Initialization complete! Please review and modify the auto-generated
'config.yml' file to ensure it contains the root directories to all
of the installed Rubies you want enhanced by the DevKit.
</pre>
这一步是为了产生config.yml供之后使用

**2.编辑查看config.yml，确认里面配置的ruby安装目录正确**
<pre>
# This configuration file contains the absolute path locations of all
# installed Rubies to be enhanced to work with the DevKit. This config
# file is generated by the 'ruby dk.rb init' step and may be modified
# before running the 'ruby dk.rb install' step. To include any installed
# Rubies that were not automagically discovered, simply add a line below
# the triple hyphens with the absolute path to the Ruby root directory.
#
# Example:
#
# ---
# - C:/ruby19trunk
# - C:/ruby192dev
#
---
- C:/ruby
</pre>

**3.执行命令**
<pre>
C:\devkit>ruby dk.rb install
[INFO] Updating convenience notice gem override for 'C:/ruby'
[INFO] Installing 'C:/ruby/lib/ruby/site_ruby/devkit.rb'
</pre>
这一步是安装devkit关联到ruby，同时安装或者更新了一个operating_system.rb文件到ruby安装目录


**4.安装jekyll[保证网络畅通，否则安装失败] ** 
  执行命令*gem install jekyll*
<pre>
C:\devkit>gem install jekyll
Fetching: liquid-2.5.5.gem (100%)
Successfully installed liquid-2.5.5
Fetching: fast-stemmer-1.0.2.gem (100%)
Temporarily enhancing PATH to include DevKit...
Building native extensions.  This could take a while...
Successfully installed fast-stemmer-1.0.2
Fetching: classifier-1.3.4.gem (100%)
Successfully installed classifier-1.3.4
Fetching: rb-fsevent-0.9.4.gem (100%)
Successfully installed rb-fsevent-0.9.4
Fetching: ffi-1.9.3-x86-mingw32.gem (100%)
Successfully installed ffi-1.9.3-x86-mingw32
......
Installing ri documentation for jekyll-1.4.3
21 gems installed
</pre>

查看jekyll版本
<pre>
C:\myblog>jekyll --version
jekyll 1.4.3
</pre>

**附加步骤1.好了现在可以使用jekyll啦【此步骤可省略】**   
如果需要代码高亮，可以安装pygments，跟随接下来的步骤

**附加步骤2.需要安装[easy_install](https://pypi.python.org/pypi/setuptools#downloads)  【此步骤可省略】**  
下载了之后执行: *python setup.py install*

**附加步骤3.安装pygments【此步骤可省略】**
<pre>
C:\devkit>easy_install Pygments
Searching for Pygments
Reading https://pypi.python.org/simple/Pygments/
Best match: Pygments 1.6
Downloading https://pypi.python.org/packages/2.7/P/Pygments/Pygments-1.6-py2.7.egg#md5=1e1e52b1e434502682aab08938163034
Processing Pygments-1.6-py2.7.egg
creating c:\python27\lib\site-packages\Pygments-1.6-py2.7.egg
Extracting Pygments-1.6-py2.7.egg to c:\python27\lib\site-packages
Adding Pygments 1.6 to easy-install.pth file
Installing pygmentize-script.py script to C:\Python27\Scripts
Installing pygmentize.exe script to C:\Python27\Scripts
Installing pygmentize.exe.manifest script to C:\Python27\Scripts

Installed c:\python27\lib\site-packages\pygments-1.6-py2.7.egg
Processing dependencies for Pygments
Finished processing dependencies for Pygments
</pre>


**6.启动jekyll**    
一个新的博客应该能够通过<http://localhost:4000/>来访问，执行如下命令
<pre>
C:\>jekyll new myblog
New jekyll site installed in C:/myblog.

C:\>cd myblog

</pre>


####在执行jekyll serve命令之前，需要注意如下事项：  
为了能够让这里网站正常运行，**这里需要删除_post文件夹里的文件**（应该有一个xxxx-xx-xx-welcome-to- jekyll.markdown字样的文件），因为这个文件内部使用了语法高亮插件（另外不删，则可以修改配置文件禁用该语法高亮插件，即**修改根目录下 _config.yml中的pygments: true为false**便可。），这个需要另外安装，不再本文范围内，不删会导致生成的静态页面有问题，因时间有限本文暂不提此问题。  
所以我们刚才安装的高亮在windows下会有问题，我们暂时就不高亮了，如果不执行如上操作，会启动报错。

####执行jekyll serve命令如下：
<pre>
C:\myblog>jekyll serve
Configuration file: C:/myblog/_config.yml
            Source: C:/myblog
       Destination: C:/myblog/_site
      Generating... error: Invalid argument - C:/myblog/_site/C:. Use --trace to view backtrace
</pre>
发现，又是报错，可能是最新版本的jekyll在windows下有版本不兼容问题，我们重新安装一个指定版本的jekyll

####我们卸载已经安装的jekyll
<pre>
C:\devkit>gem uninstall jekyll
Remove executables:
        jekyll

in addition to the gem? [Yn]  Y
Removing jekyll
Successfully uninstalled jekyll-1.4.3
</pre>


####重新安装jekyll，指定版本号：  
<pre>
C:\devkit>gem install jekyll --version "=1.4.2"
Fetching: jekyll-1.4.2.gem (100%)
Successfully installed jekyll-1.4.2
Parsing documentation for jekyll-1.4.2
Installing ri documentation for jekyll-1.4.2
1 gem installed
</pre>


####重新创建博客目录，启动博客：
<pre>
C:\>rm -rf myblog
C:\>jekyll new myblog
New jekyll site installed in C:/myblog.

C:\>cd myblog

C:\myblog>rm -rf _posts

C:\myblog>jekyll serve
Configuration file: C:/myblog/_config.yml
            Source: C:/myblog
       Destination: C:/myblog/_site
      Generating... done.
    Server address: http://0.0.0.0:4000
  Server running... press ctrl-c to stop.
</pre>


####这个时候通过<http://localhost:4000/>来访问,也可通过jekyll server启动

查看gem环境变量
<pre>
C:\myblog>gem env
RubyGems Environment:
  - RUBYGEMS VERSION: 2.0.14
  - RUBY VERSION: 2.0.0 (2013-11-22 patchlevel 353) [i386-mingw32]
  - INSTALLATION DIRECTORY: C:/ruby/lib/ruby/gems/2.0.0
  - RUBY EXECUTABLE: C:/ruby/bin/ruby.exe
  - EXECUTABLE DIRECTORY: C:/ruby/bin
  - RUBYGEMS PLATFORMS:
    - ruby
    - x86-mingw32
  - GEM PATHS:
     - C:/ruby/lib/ruby/gems/2.0.0
     - C:/Users/Administrator/.gem/ruby/2.0.0
  - GEM CONFIGURATION:
     - :update_sources => true
     - :verbose => true
     - :backtrace => false
     - :bulk_threshold => 1000
  - REMOTE SOURCES:
     - https://rubygems.org/
</pre>


---

#jekyll怎样创建一篇文章
##第一步，创建项目。
在你的电脑上，建立一个目录，作为项目的主目录。我们假定，它的名称为jekyll_demo。  
>mkdir jekyll_demo


对该目录进行git初始化。  
>cd jekyll_demo
>
>git init


然后，创建一个没有父节点的分支gh-pages。**因为github规定，只有该分支中的页面，才会生成网页文件**。  
>$ git checkout --orphan gh-pages


以下所有动作，都在该分支下完成。


##第二步，创建设置文件。
在项目根目录下，建立一个名为_config.yml的文本文件。它是jekyll的设置文件，我们在里面填入如下内容，其他设置都可以用默认选项，具体解释参见[官方网页](https://github.com/jekyll/jekyll/wiki/Configuration)

>baseurl: /jekyll_demo


目录结构变成：
<pre>
　/jekyll_demo
　　　　|--　_config.yml
</pre>


##第三步，创建模板文件。  
在项目根目录下，创建一个_layouts目录，用于存放模板文件。  
>$ mkdir _layouts


进入该目录，创建一个default.html文件，作为Blog的默认模板。并在该文件中填入以下内容。  
```html
　<!DOCTYPE html>
　　<html>
　　<head>
　　　　<meta http-equiv="content-type" content="text/html; charset=utf-8" />
　　　　<title>{{ page.title }}</title>
　　</head>
　　<body>

　　　　{{ content }}

　　</body>
　　</html>
```

Jekyll使用[Liquid](https://github.com/shopify/liquid/wiki/liquid-for-designers)模板语言，{{ page.title }}表示文章标题，{{ content }}表示文章内容，更多模板变量请参考[官方文档](https://github.com/jekyll/jekyll/wiki/Template-Data)。

目录结构变成：
<pre>
　/jekyll_demo
　　　　|--　_config.yml
　　　　|--　_layouts
　　　　|　　　|--　default.html
</pre>


##第四步，创建文章。

回到项目根目录，创建一个_posts目录，用于存放blog文章。
>mkdir _posts

进入该目录，创建第一篇文章。文章就是普通的文本文件，文件名假定为2014-01-21-hello-world.html。(注意，文件名必须为"年-月-日-文章标题.后缀名"的格式。如果网页代码采用html格式，后缀名为html；如果采用markdown格式，后缀名为md。）


在该文件中，填入以下内容：（注意，行首不能有空格）
```html
　---
　　layout: default
　　title: 你好，世界
　　---
　　<h2>{{ page.title }}</h2>
　　<p>我的第一篇文章</p>
　　<p>{{ page.date | date_to_string }}</p>
```


每篇文章的头部，必须有一个yaml文件头，用来设置一些元数据。它用三根短划线"---"，标记开始和结束，里面每一行设置一种元数据。"layout:default"，表示该文章的模板使用_layouts目录下的default.html文件；"title:你好，世界"，表示该文章的标题是"你好，世界"，如果不设置这个值，默认使用嵌入文件名的标题，即"hello world"。  
在yaml文件头后面，就是文章的正式内容，里面可以使用模板变量。{{ page.title }}就是文件头中设置的"你好，世界"，{{ page.date }}则是嵌入文件名的日期（也可以在文件头重新定义date变量），"| date_to_string"表示将page.date变量转化成人类可读的格式。  
目录结构变成：
<pre>
　/jekyll_demo
　　　　|--　_config.yml
　　　　|--　_layouts
　　　　|　　　|--　default.html 
　　　　|--　_posts
　　　　|　　　|--　2012-08-25-hello-world.html
</pre>


##第五步，创建首页。
有了文章以后，还需要有一个首页。  
回到根目录，创建一个index.html文件，填入以下内容。  
```html
---
　　layout: default
　　title: 我的Blog
　　---
　　<h2>{{ page.title }}</h2>
　　<p>最新文章</p>
　　<ul>
　　　　{% for post in site.posts %}
　　　　　　<li>{{ post.date | date_to_string }} <a href="{{ site.baseurl }}{{ post.url }}">{{ post.title }}</a></li>
　　　　{% endfor %}
　　</ul>
```

它的Yaml文件头表示，首页使用default模板，标题为"我的Blog"。然后，首页使用了{% for post in site.posts %}，表示对所有帖子进行一个遍历。这里要注意的是，Liquid模板语言规定，输出内容使用两层大括号，单纯的命令使用一层大括号。至于{{site.baseurl}}就是_config.yml中设置的baseurl变量。  
目录结构变成：  
<pre>
　/jekyll_demo
　　　　|--　_config.yml
　　　　|--　_layouts
　　　　|　　　|--　default.html 
　　　　|--　_posts
　　　　|　　　|--　2014-01-21-hello-world.html
　　　　|--　index.html
</pre>


##第六步，发布内容。

现在，这个简单的Blog就可以发布了。先把所有内容加入本地git库。  
>git add .
>
>git commit -m "first post"


然后，前往github的网站，在网站上创建一个名为jekyll_demo的库。接着，再将本地内容推送到github上你刚创建的库。注意，下面命令中的username，要替换成你的username。

>git remote add origin git@github.com:username/jekyll_demo.git
>
>git push origin gh-pages



上传成功之后，等10分钟左右，访问<http://username.github.io/jekyll_demo/>就可以看到Blog已经生成了（将username换成你的用户名）。


all right : click me <http://cinowu.github.io/jekyll_demo/>


ps:article from runyifeng's [blog](http://www.ruanyifeng.com/blog/2012/08/blogging_with_jekyll.html)


##btw
在往github推送之前，可以在本地通过jekyll启动测试一下  
可能会出现编码问题，更改vi _config.yml
<pre>
encoding: utf-8
#baseurl: /jekyll_demo
</pre>

在jekyll-demo目录下执行启动  
<pre>
$ jekyll build
Configuration file: f:/jekyll_demo/_config.yml
            Source: f:/jekyll_demo
       Destination: f:/jekyll_demo/_site
      Generating... done.

Administrator@PC121106ZS04 /f/jekyll_demo (gh-pages)
$ jekyll serve
Configuration file: f:/jekyll_demo/_config.yml
            Source: f:/jekyll_demo
       Destination: f:/jekyll_demo/_site
      Generating... done.
    Server address: http://0.0.0.0:4000
  Server running... press ctrl-c to stop.
</pre>

访问<http://localhost:4000>


##最后
我们可以参考下<https://github.com/jekyll/jekyll/wiki/sites>,这个链接中列举了许多用jekyll创建的github博客


##附加几种常用博客系统说明
###Jekyll 和 Octopress
Jekyll 和 Octopress 本是同源，所以本质上差别不大。Octopress 是基于 Jekyll 的。他们的关系就像 jQuery 与 js 的关系一样。  
jekyll建议用jekyll-bootstrap框架<https://github.com/rose1988c/jekyll-bootstrap>
Jekyll本是blog系统，但与wordpress不同，Jekyll是为静态文件blog而设计的，本地安装Jekyll后，可以使用jekyll   --server开启一个blog服务，也可以自己配置服务。jekyll的厉害之处也是她的原理是可以把markdown、textile等模板语言直接转换成html，还能像使用php等语言一样使用模板、引入模块，使用插件。markdown\textile语言是非常友好和方便的，是很多开发者非常喜爱和常用的静态模板语言，用于写博客和记录信息非常清晰便利。  
Github支持Jekyll（同一开发者），在内部已经配置好了Jekyll，允许用户把Jekyll博客当作一个项目发布到Github，博客的所有文件通过git管理，永远都不会丢失，只要用户提交，Github自动会调用Jekyll，为用户把md和textile转换成可访问的html，所以用户也可以不在本地先转换格式。另外Github为用户的博客项目配置独立服务，使得可以以<http://username.github.io>方式访问，更可以设置CNAME指定另外的域名，还有很多功能，自己去发掘吧。  
可以简单点理解，Jekyll是一套博客系统，而Github提供博客托管服务  
<http://yanping.me/cn/blog/2013/08/11/github-pages-step-by-step-video/>


**ekyll 和 Octopress上传发布细微区别:**
jekyll 可以直接用git上传 .md or .html 文件不需要编译  
Otcopress是makefile将文件转化.html发布。说的有点复杂了，其实就是编译成一个静态网站。  
Octopress 文章多了编译难免很慢  



###Hexo框架（Nodo.js）  
又多了一种选择。  
<http://zespia.tw/hexo/>
<https://github.com/tommy351/hexo>


###pelican（python）
<http://www.lizherui.com/pages/2013/08/17/build_blog.html#comment-1082841744>




当你开始搭建一个个人博客的时候，会出现类似这么多的博客系统干扰你，我要坚持搞好jekyll!!!



##接下来jekyll要做的事情
- 选择主题 
- 加上第三方评论系统
- 接入新浪腾讯微博
- 加入Google Analytics
- 加入Google Webmasters
- 申请域名，更换域名

参考  
<http://www.lizherui.com/pages/2013/08/17/build_blog.html#comment-1082841744>  
<http://beiyuu.com/why-blog/>  
<http://beiyuu.com/github-pages/#github>



---

#用Jekyll构建基于bootstrap模板
##下载模板
1.从github下载模板
>git clone https://github.com/plusjade/jekyll-bootstrap.git jekyll

2.进入项目目录
>cd /f/jekyll

3.查看文件
<pre>
$ ls
404.html          Rakefile     _includes  _posts        assets           changelog.md  rss.xml
History.markdown  _config.yml  _layouts   _site         atom.xml         index.md      sitemap.txt
README.md         _drafts      _plugins   archive.html  categories.html  pages.html    tags.html
</pre>

4.启动服务
>jekyll server

##开始写文章
- 编写新文章(Post)
- 编写新页面(Page)

1.编写新文章(Create a Post)  

1.1）通过命令生成文章
<pre>
Administrator@PC121106ZS04 /f/jekyll (master)
$ rake post title="Hello World"
Creating new post: ./_posts/2014-01-22-hello-world.md

Administrator@PC121106ZS04 /f/jekyll (master)
$ ls _posts/
2014-01-22-hello-world.md  core-samples
</pre>

1.2）由上看到生成了年月日标题格式的文章，查看2014-01-22-hello-world.md
<pre>
Administrator@PC121106ZS04 /f/jekyll (master)
$ cat _posts/2014-01-22-hello-world.md
---
layout: post
title: "Hello World"
description: ""
category:
tags: []
---
{% include JB/setup %}
</pre>

1.3）添加内容到生成的2014-01-22-hello-world.md最后
<pre>
## 第一页，jekyll的开始

Jekyll is a parsing engine bundled as a ruby gem used to build static websites from
dynamic components such as templates, partials, liquid code, markdown, etc. Jekyll is known as "a simple, blog aware, static site generator".

### 博客文章：[用Jekyll构建基于bootstrap系统](http://blog.fens.me/jekyll-bootstarp-doc/)

程序员会写程序是基本技能，程序员会写文档是更高的能力。用简单的图形表达架构，用流畅语言描述业务，用专业的文笔写成报告，看似简单的要求，但对于普通的程序员来说都是一种挑战。

有时候我们纠结的不是怎么组织文字，而是怎么排版，用哪种字体，居中还是靠右放置？如何能保持多人撰写文档的统一风格？

Jekyll可以帮助我们标准化文档结构，文档样式，文档过程。剩下就是提升自己的知识基础了。
</pre>

1.4）保存后启动
<pre>
Administrator@PC121106ZS04 /f/jekyll (master)
$ jekyll serve
Configuration file: f:/jekyll/_config.yml
            Source: f:/jekyll
       Destination: f:/jekyll/_site
      Generating...   Conversion error: There was an error converting '_posts/2014-01-22-hello-world.md'.
error: incompatible encoding regexp match (UTF-8 regexp with GBK string). Use --trace to view backtrace
</pre>

启动失败，发现中文GBK编码导致


##**jelly中文乱码终极解决方案**  
###更换1
找到C:\ruby\lib\ruby\gems\2.0.0\gems\jekyll-1.4.2\lib\jekyll\convertible.rb的第38行
<pre>
        self.content = File.read_with_options(File.join(base, name),
                                              merged_file_read_opts(opts))
</pre>
将如下换成:
<pre>
self.content = File.read_with_options(File.join(base, name), :encoding => "utf-8")
</pre>

###更换2
找到C:\ruby\lib\ruby\gems\2.0.0\gems\jekyll-1.4.2\lib\jekyll\tags\include.rb的如下部分：
<pre>
File.read_with_options(file, file_read_opts(context))
</pre>
换成如下：
<pre>
File.read_with_options(file, :encoding => "utf-8")
</pre>

有关中文乱码其他解决方案请参考：  
<http://blog.jsfor.com/skill/2013/09/07/jekyll-local-structures-notes/>
<http://yanping.me/cn/blog/2012/10/09/chinese-charset-problems-with-jekyll/>
<https://github.com/fitztrev/jekyll-utf8>


保存后重新启动服务
<pre>
$ jekyll serve
Configuration file: f:/jekyll/_config.yml
            Source: f:/jekyll
       Destination: f:/jekyll/_site
      Generating... done.
    Server address: http://0.0.0.0:4000
  Server running... press ctrl-c to stop.
</pre>
打开<http://localhost:4000/2014/01/22/hello-world/>


2.编写新页面(Create a Page)
2.1）通过命令生成页面
<pre>
Administrator@PC121106ZS04 /f/jekyll (master)
$ rake page name="about.md"
mkdir -p .
Creating new page: ./about.md
</pre>
在about.md最后添加如下内容:
>关于作者<http://javacrazyer.iteye.com/>

再生成一个页面
<pre>
$ rake page name="pages/about"
mkdir -p ./pages/about
Creating new page: ./pages/about/index.html
</pre>
这个页面最后也可以添加一段内容，如下：
>我也是我一个页面

##发布到GitHub
在github网站，我们创建一个新的库，jekyll_demo2

把jekll项目，添加到jekyll_demo2
>git remote set-url origin git@github.com:cinowu/jekyll_demo2.git

因为是项目主页，所以创建分支
>git checkout gh-pages

修改_config.xml
>production_url : http://cinowu.github.io
>
>BASE_PATH : /jekyll_demo2

提交更改
>git add .
>
>git commit -m "add modify"
>
>git push origin gh-pages

大概十分钟之后访问：<http://cinowu.github.io/jekyll_demo2/>

本文参考自：<http://blog.fens.me/jekyll-bootstarp-github/>

**注意**我们前面两次讲到的都是本地更改后，github上创建一个新的库然后提交，都是基于项目首页的，如果已经提交之后再改，那么每次改之前都要在本地git pull origin gh-pages一下最新的变动